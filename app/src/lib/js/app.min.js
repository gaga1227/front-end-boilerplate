var app=angular.module("app",[]);app.controller("productsController",["productsService",function(i){this.isLoading=!1,this.loadingMessage="Loading products...",this.isLoadingError=!1,this.errorMessage="Products information is unavailable right now, please try again later.",this.sizeOptions=[],this.selectedSizeOption=null,this.items=[],this.loadProductsData=function(){this.isLoading=!0,i.getProducts().success(function(i){this.onProductsDataSuccess(i)}.bind(this)).error(function(i,t){this.onProductsDataError(i,t)}.bind(this)).finally(function(){this.isLoading=!1}.bind(this))},this.onProductsDataSuccess=function(t){if(!angular.isArray(t)||!t.length)return this.isLoadingError=!0,console.error("Invalid products data",t),!1;this.isLoadingError=!1,this.items=angular.copy(t),this.sizeOptions=i.getSizeOptions(this.items)},this.onProductsDataError=function(i,t){this.isLoadingError=!0,console.error("Error retrieving products information:",i,t)},this.matchSelectedSize=function(i){return!this.selectedSizeOption||!(!angular.isArray(i)||!i.length)&&-1!=i.indexOf(this.selectedSizeOption)},this.loadProductsData()}]),app.service("productsService",["$http",function(i){this.standardSizeOptions=["XS","S","M","L","XL"],this.getProducts=function(){return i({method:"GET",url:"lib/data/products.json"})},this.getSizeOptions=function(i){var t=[];return i.forEach(function(i){var r=i.size;angular.isArray(r)&&(t=t.concat(r))}),t=t.filter(function(i,t,r){return t==r.indexOf(i)}),(t=t.filter(function(i,t,r){return-1!=this.standardSizeOptions.indexOf(i)}.bind(this))).sort(this._compareSizeOption.bind(this))},this._compareSizeOption=function(i,t){var r=this.standardSizeOptions;return r.indexOf(i)-r.indexOf(t)}}]);